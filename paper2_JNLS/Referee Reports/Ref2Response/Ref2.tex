\documentclass[11pt]{article}


\usepackage{fullpage}
\usepackage{graphicx,amsmath,amsfonts,amssymb,stmaryrd}
\usepackage{color}
\newcommand{\comment}[1]{{\color{blue} #1}}

%----------------------------- CUSTOM COMMANDS -----------------------------%

% Basic editing
\newcommand{\tocite}{{\color{blue}(to cite)}}
\newcommand{\vsp}[1]{\vspace{#1 pc} \noindent}
\newcommand{\np}{\newpage \noindent}
\newcommand{\HERE}[1]{ \vsp{#1} {\color{blue} HERE} }
% Mathy stuff
\newcommand{\abs}[1]{\lvert #1 \rvert}
\newcommand{\omavg}{\omega_0}
\newcommand{\omsig}{\sigma_{\omega}}
\newcommand{\dth}{\Delta \theta}
\newcommand{\dom}{\Delta \omega}
\newcommand{\etag}{\eta_{\gamma}}
\newcommand{\etastd}{\eta_{\text{std}}}
\newcommand{\mean}[1]{\left< #1\right>}

% Upstream and downstream notation (not used)
\newcommand{\hm}{h^-}
\newcommand{\hp}{h^+}
\newcommand{\lamm}{\lambda^-}
\newcommand{\lamp}{\lambda^+}
\newcommand{\km}{k^-}
\newcommand{\kp}{k^+}
\newcommand{\khm}{(kh)^-}
\newcommand{\khp}{(kh)^+}


%----------------------------- DOCUMENT -----------------------------%
\begin{document}

\section*{Responses to Referee 2}

We thank the referee for the careful review of our work, which has helped us greatly to improve and clarify the manuscript. Below we respond to each of the referee's comments in sequence. For your convenience, we are submitting a version of the revised manuscript with the changes highlighted. \\ \\ \\


% COMMENT
\noindent
\comment{A nice paper with agreement between theory and experiments, and novel new results.} \\

\noindent
We thank the referee for these positive remarks. \\ \\

% COMMENT 1
\noindent
\comment{
Use of qualitative adjectives where a quantitative description may be better: \\
Pg 1 Ln 39: spectacular \\
Pg 17 Ln 17: intriguing \\
Pg 18 Ln 36: modest \\
Pg 19 Ln 37: roughly \\
Pg 20 Ln 42: remarkably} \\

\noindent
We have replaced all but one of these descriptors with more quantitative ones. In particular:
\begin{itemize}
\item The term `spectacular fashion' in the abstract was changed to `convincing evidence'.
\item The word `modest' on page 18 was replaced with `moderate'. Thanks for pointing this out -- I believe `moderate' was the word that was originally intended and `modest' was simply a mistake.
\item The word `roughly' (appearing in several places in the original manuscript) was either replaced by `approximately' or else removed.
\item The phrase `captures the trend remarkably well' on page 20 was changed to `the data is well predicted by formula (53)'.
\item We have kept `intriguing' on page 17 as we believe it to be an appropriate use of the word.
\end{itemize}
\hphantom \\

% COMMENT 2
\noindent
\comment{On Pg 5 Ln 44, it is said that ``the location of the peak is the same for skewness and kurtosis and appears insensitive to driving amplitude''. Can you elaborate on ``appears" to say whether it is or not?}

\begin{itemize}
\item As can bee seen in Fig. 2 (b) and (c), the location of the peak is indeed insensitive to driving amplitude to within experimental error (the level of error can be visually estimated by the noise in the data). Accordingly, we have replaced `appears insensitive' to simply `is insensitive'.
We had initially used the word `appears' to encourage the reader to view the figure and see for themselves. However, we now see the referee's point that this word may weaken our statement and introduce some uncertainty in the reader's mind.
\end{itemize}

% COMMENT 3
\noindent
\comment{Section 4.1 refers to Figure 3(b). If you increase $N$, with the transfer function become eventually collapse to one single curve? If so or indeed if not, why choose the $N$ and $\Lambda$ in this range?}

\begin{itemize}
\item This is a great question and one that we have already devoted some effort to understanding. First, it is unclear whether the transfer function converges to a single curve in the limit $\Lambda \to \infty$ and this is a question currently under investigation (see more below). Second, to briefly explain our choices, we selected the system size $\Lambda$ as a moderate value that is large enough to capture sufficiently rich dynamics and small enough to be computationally tractable. Meanwhile, we chose $N = \Lambda / 2$ so that the dominant forcing frequency $f_p$ sits near the (logarithmic) middle of resolved scales in the model. See sections 3.4 and especially 3.9 in the manuscript for a detailed discussion of the parameter $N$. In particular, Section 3.9 outlines a simple scaling argument that suggests scaling $N$ linearly with $\Lambda$ offsets the sensitivity of the transfer function to $\Lambda$ for asymptotically large $\Lambda$ (it is unclear, however, if the sensitivity has been mitigated enough).

\item To add a bit more detail, the parameter $\Lambda$ can be regarded as the dynamic range of the model since it corresponds to the number of resolved modes. In other work, a subset of the authors examined more severely truncated systems -- as small as two interacting modes -- that were shown to qualitatively capture many statistical features of the experiments (see reference 31). Since the goal of the present work is a {\em quantitative} comparison with experiments, we chose a larger dynamic range. We found $\Lambda = 16$ to yield a sufficiently rich dynamical system that quantitatively compares well to the experiments, while also being manageable from a computational perspective (considering that each trajectory requires integration with a small time step over a long time horizon, and we sample over many trajectories). See in particular Section `4.1: Calibration of the inverse temperature', where we present some results for varied system sizes. It also bears mentioning that powers of 2 are computationally faster since our sampling and simulation algorithms involve the use of FFTs. This is another reason that $\Lambda = 16$ was chosen.
	
\item In  work currently underway, we are developing tailored sampling algorithms that will enable us to compute the transfer function for larger system sizes and address the question of whether the transfer function converges to a single curve, or whether a more sophisticated scaling relationship than that discussed in Section 3.9 is required to obtain system-size insensitivity. We hope to report on these findings soon.

\item Finally, we would like to point out that, since the KdV equation is asymptotically valid only for large spatial scales, increasing $\Lambda$ does not necessarily improve the physical accuracy of the model past a certain point. These small scales lie outside the range of validity of long-wave theory and a more accurate physical description would require either direct numerical simulation of the Euler equations or else a model closure that captures the small-scale physics. We have included this point in the updated manuscript in Section 3.4:
\begin{quotation}
We comment on some important differences between the KdV and TKdV dynamical systems. Besides momentum, energy, and Hamiltonian, KdV possesses in infinite sequence of additional invariants [26, 52]. Trajectories of KdV are therefore constrained by infinitely many conserved quantities, associated with the fact that it is a completely integrable system. The long-time dynamics of KdV are dominated by coherent structures, namely solitons. With finite truncation, however, the additional invariants cease to be conserved. The only known invariants of TKdV are the three mentioned already: momentum, energy, and Hamiltonian. Thus, finite truncation breaks integrability. Moreover, although soliton solutions are supported by TKdV, the long-time dynamics are not dictated by these structures. Rather, the finite truncation induces chaotic to weakly turbulent dynamics, as has been observed numerically [2, 31]. Stronger mixing is induced
with energy cascades down and up scales.
\end{quotation}
\end{itemize}

% COMMENT 4
\noindent
\comment{For the experiments, images are taken at 60 frames/sec. The numerical differentiation of images of the free surface uses Savitzky-Golay smoothing filters. However, on Pg 18 it is mentioned that there are measurement errors and the differentiation amplifies errors. Can you comment further on this method by, say, looking at how it converges while only looking the images from 20 and 40 frames/sec or by calculating $\eta_x$ by a spectral method from eta? }

\begin{itemize}
\item First, the numerical differentiation to extract surface slope, $\eta_x$, is differentiation in space, not time. Hence, the results do not depend on the frame rate that is used; the numerical differentiation is applied to each frame separately.

Our protocol for numerically differentiating the experimental data admittedly developed with some trial-and-error. I believe this to be typical for the tricky task of numerically differentiating data with a noise -- a task that is well understood to be ill-posed in the strictest mathematical sense, but one that can nonetheless be achieved to a reasonable degree of accuracy with the understanding that the process will never be perfect. Because the problem is ill-posed, a convergence test on the experimental data is not possible to my knowledge. As the resolution increases, the error would decrease to a point, but then dramatically increase as the noise becomes amplified without bound. It is conceivable that a convergence test could be conducted on artificial data, in which noise is added in a controlled fashion, and the spatial resolution and smoothing parameters are linked to the noise level. Such a test lies outside the scope of the present paper though.

Instead, we can briefly report on our trial-and-error process, including the idea of differentiating spectrally as suggested by the referee. Spectral differentiation of the experimental data was among the first ideas tried, but difficulties were encountered. First, it is necessary to choose a spatial domain (perhaps the entire width of the frame, or else some truncated window), but the data will not generally be periodic over this domain. Hence, the spectrum decays slowly, like $k^{-1}$, due to the mismatch of the endpoints, and numerical differentiation effectively multiplies by $k$, thus giving a spectrum that does not decay and hence a signal of $\eta_x$ that is entirely too noisy. This problem can be alleviated by `windowing' the data, that is, forcing it to zero at the endpoints smoothly, but such a process introduces a several decisions and tunable parameters which we found to give more uncertainty than we were comfortable with. We settled on the idea of `smooth differentiation' through Savitzky-Golay filters due to the relatively small number of tunable parameters and the conceptual simplicity. We experimented with varying the order of the polynomial and the width of the smoothing window and found results to be reasonably consistent.
\end{itemize}

% COMMENT 5
\noindent
\comment{Fig 6 could use a label for the colourbar.}

\begin{itemize}
\item We have added  labels for the colourbars in Fig.~6.
\end{itemize}

% COMMENT 6
\noindent
\comment{Sharp steps do occur in bathymetry profiles. However, do you think Eq (53) will still apply rather well over other bathymetry profiles such as a transition with a steep finite gradient?}
\begin{itemize}
\item This is a good question. Since the wave response depends continuously on bottom topography, one would expect a surface of finite, steep slope to produce behavior similar to what we observe. How steep the surface must be for a reasonable comparison is a more difficult question, but perhaps some insight can be gained through back-of-the-envelope scaling analysis. The relevant length-scale for the wave response is the wavelength. Essentially, waves cannot ``see'' scales in the bathymetry that are much smaller. Hence, a bathymetric change that takes place over a horizontal scale much smaller than a wavelength would be nearly indistinguishable from an abrupt depth change. Upon reflection, this line of thought implies, perhaps surprisingly, that it is not necessarily the slope of the surface that matters directly. For example, if the water depth is much smaller than the wavelength, then a mild slope could cause an appreciable change in depth that takes place over a horizontal distance much smaller than the wavelength. To give a concrete (yet somewhat exaggerated) example, suppose depth/wavelength = 1/10 and the bottom slope is 1/5. Then a change of 50\% in the depth occurs over 1/4 of a wavelength. Hence, in this scenario, a mild bottom slope of 1/5 might reasonably be approximated by an abrupt depth change.
\item I would also like to mention that an interesting line of future work is to extend our theory to multiple depth changes. Once that is achieved, it might be possible to approximate arbitrary bathymetry (e.g.~a smooth one) by a sequence of abrupt depth changes and examine the associated statistical transitions.
\end{itemize}

% COMMENT 7
\noindent
\comment{Minor typos etc.
\\Pg 6 Ln 60: is leading-order $\to$ is the leading-order %Corrected
\\Pg 7 Ln 21: change dash to en or em dash as appropriate % Corrected
\\Pg 16 Ln 35: Fig. 3(b) $\to$ Fig. 3(c)%Corrected
\\Pg 24: References [17] and [24] require capitals as they are book titles, and [27] requires a capital H for Hamiltonian %Corrected
}
\begin{itemize}
\item We have corrected these typos. Thank you for bringing them to our attention.
\end{itemize}

\end{document}
